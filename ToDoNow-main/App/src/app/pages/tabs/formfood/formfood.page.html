<ion-header>
  <ion-toolbar>
    <ion-title>Mi Inventario</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-spinner *ngIf="loading"></ion-spinner>

  <!-- Formulario de creación de nuevo alimento -->
  <ion-card>
    <ion-card-header>
      <ion-card-title>Crear Nuevo Alimento</ion-card-title>
    </ion-card-header>

    <ion-card-content>
      <form [formGroup]="newFoodForm" (ngSubmit)="addNewFood()">
        <ion-item>
          <ion-label position="floating">Nombre</ion-label>
          <ion-input formControlName="name" type="text" required></ion-input>
        </ion-item>
        <ion-item>
          <ion-label position="floating">Precio Nº1</ion-label>
          <ion-input formControlName="price" type="number" required></ion-input>
        </ion-item>
        <ion-item>
          <ion-label position="floating">Precio Nº2</ion-label>
          <ion-input formControlName="price2" type="number" required></ion-input>
        </ion-item>
        <ion-item>
          <ion-label position="floating">Calorías</ion-label>
          <ion-input formControlName="calories" type="number" required></ion-input>
        </ion-item>

        <!-- Agrega ion-select para la categoría -->
        <ion-item>
          <ion-label>Categoría</ion-label>
          <ion-select formControlName="categoria" interface="action-sheet">
            <ion-select-option *ngFor="let categoria of categorias" [value]="categoria">{{ categoria }}</ion-select-option>
          </ion-select>
        </ion-item>

        <ion-item>
          <ion-label position="floating">Imagen URL</ion-label>
          <ion-input formControlName="imagen" type="text" required></ion-input>
        </ion-item>
        <ion-item>
          <ion-label position="floating">Grasas</ion-label>
          <ion-input formControlName="fat" type="number" required></ion-input>
        </ion-item>
        <ion-item>
          <ion-label position="floating">Grasas saturadas</ion-label>
          <ion-input formControlName="fat_sat" type="number" required></ion-input>
        </ion-item>
        <ion-item>
          <ion-label position="floating">Grasas trans</ion-label>
          <ion-input formControlName="fat_trans" type="number" required></ion-input>
        </ion-item>
        <ion-item>
          <ion-label position="floating">Sodio</ion-label>
          <ion-input formControlName="sodio" type="number" required></ion-input>
        </ion-item>
        <ion-item>
          <ion-label position="floating">Carbohidratos</ion-label>
          <ion-input formControlName="carbs" type="number" required></ion-input>
        </ion-item>
        <ion-item>
          <ion-label position="floating">Proteína</ion-label>
          <ion-input formControlName="protein" type="number" required></ion-input>
        </ion-item>
        <ion-item>
          <ion-label position="floating">Colesterol</ion-label>
          <ion-input formControlName="colesterol" type="number" required></ion-input>
        </ion-item>
        <ion-item>
          <ion-label position="floating">Fibra</ion-label>
          <ion-input formControlName="fibra" type="number" required></ion-input>
        </ion-item>
        <ion-item>
          <ion-label position="floating">Unidad Medida</ion-label>
          <ion-input formControlName="medida" type="text" required></ion-input>
        </ion-item>
        <ion-item>
          <ion-label position="floating">Código de Barras</ion-label>
          <ion-input formControlName="codigoBarras" type="text" required></ion-input>
          <ion-button slot="end" (click)="scanBarcode()">Escanear</ion-button>
        </ion-item>

        <ion-button type="submit" expand="block" [disabled]="!newFoodForm.valid">Agregar Alimento</ion-button>
      </form>
    </ion-card-content>
  </ion-card>

  <ion-note *ngIf="foods.length === 0 && !loading">No hay alimentos disponibles.</ion-note>

  <!-- Vista de la cámara para escaneo de código de barras ---------------------->
  <div class="video-container">
    <video #videoElement id="video" playsinline autoplay style="width: 100%; height: auto; transform: scaleX(-1);"></video>
    <canvas #canvasElement style="display: none;"></canvas>
  </div>
</ion-content>
