<ion-content [fullscreen]="true">
  <app-header title="Lista de Compras"></app-header>
  <app-logo></app-logo>

  <div class="contenido">
    <div class="titulo">
      <h1 class="d-flex-center">{{ newlist?.nombre }}</h1>
    </div>

    <ion-back-button slot="start" defaultHref="/tabs/newlist">Volver atrás</ion-back-button>

    <ion-card class="custom-card" *ngIf="newlist">
      <ion-card-header class="custom-card-header">
        <ion-card-title>Total Lista: {{ newlist.total | currency:'CLP':'symbol-narrow':'1.0-0' }}</ion-card-title>
      </ion-card-header>

      <ion-card-content>
        <ion-grid>
          <ion-row class="table-header">
            <ion-col size="3">Producto</ion-col>
            <ion-col size="3">Cantidad</ion-col>
            <ion-col size="3">Precio</ion-col>
            <ion-col size="3">Total</ion-col>
          </ion-row>

          <ion-row class="table-row" *ngFor="let alimento of newlist.alimentos; let i = index">
            <ion-col size="3" class="table-cell product-info">
              <div class="product-display">
                <img [src]="alimento.imagen" alt="{{ alimento.nombre }}" class="product-image"/>
                <span class="product-name">{{ alimento.nombre }}</span>
              </div>
            </ion-col>

            <ion-col size="3" class="table-cell quantity-controls">
              <div class="quantity-wrapper">
                <!-- Botones ahora están uno sobre el otro, con cantidad al lado -->
                <div class="buttons">
                  <ion-button size="small" fill="outline" (click)="actualizarCantidad(alimento, alimento.cantidad + 1)">
                    <ion-icon name="add-circle-outline"></ion-icon>
                  </ion-button>
                  <ion-button size="small" fill="outline" (click)="actualizarCantidad(alimento, alimento.cantidad - 1)">
                    <ion-icon name="remove-circle-outline"></ion-icon>
                  </ion-button>
                </div>
                <span class="quantity-display">{{ alimento.cantidad }}</span>
              </div>
            </ion-col>

            <ion-col size="3" class="table-cell">
              <ion-select [(ngModel)]="alimento.precioSeleccionado" (ionChange)="actualizarTotalLista()">
                <ion-select-option [value]="alimento.precio">Precio</ion-select-option>
                <ion-select-option [value]="alimento.precio2">Precio 2</ion-select-option>
              </ion-select>
            </ion-col>
            <ion-col size="3" class="table-cell wide-cell">
              {{ (alimento.cantidad * alimento.precioSeleccionado) | currency:'CLP':'symbol-narrow':'1.0-0' }}
            </ion-col>
          </ion-row>
        </ion-grid>

      </ion-card-content>
    </ion-card>

    <ion-spinner *ngIf="loading"></ion-spinner>
  </div>
</ion-content>
